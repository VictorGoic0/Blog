{% extends "base.html" %}
{% block title %}All Posts{% endblock %}
{% block meta_description %}Victor Goico's blog — technical writing, development, and building in public.{% endblock %}
{% block content %}
<h1 class="index-title">Blog</h1>

{% if all_tags %}
<div class="tag-filter" role="group" aria-label="Filter by tag">
    <span class="tag-filter-label">Filter:</span>
    <div class="tag-filter-buttons">
        <button type="button" class="tag-filter-btn active" data-tag="">All</button>
        {% for tag in all_tags %}
        <button type="button" class="tag-filter-btn" data-tag="{{ tag }}">{{ tag }}</button>
        {% endfor %}
    </div>
</div>
{% endif %}

<ul class="post-list">
{% for post in posts %}
    <li class="post-list-item" data-tags="{{ post.tags | join(' ') }}">
        <h2 class="post-list-title"><a href="/{{ post.url }}">{{ post.title }}</a></h2>
        <p class="post-list-meta">
            <time datetime="{{ post.date_iso }}">{{ post.date_display }}</time>
            <span aria-hidden="true"> · </span>
            {{ post.read_time_min }} min read
            {% if post.tags %}
            <span aria-hidden="true"> · </span>
            {% for tag in post.tags %}<span class="tag">{{ tag }}</span>{% if not loop.last %} {% endif %}{% endfor %}
            {% endif %}
        </p>
        {% if post.excerpt %}<p class="post-list-excerpt">{{ post.excerpt }}</p>{% endif %}
    </li>
{% endfor %}
</ul>

<script>
(function() {
  var buttons = document.querySelectorAll('.tag-filter-btn');
  var items = document.querySelectorAll('.post-list-item');
  if (!buttons.length || !items.length) return;
  buttons.forEach(function(btn) {
    btn.addEventListener('click', function() {
      var tag = (this.getAttribute('data-tag') || '').toLowerCase();
      buttons.forEach(function(b) { b.classList.remove('active'); });
      this.classList.add('active');
      items.forEach(function(item) {
        var tags = (item.getAttribute('data-tags') || '').toLowerCase().split(/\s+/);
        var show = !tag || tags.indexOf(tag) !== -1;
        item.classList.toggle('hidden', !show);
      });
    });
  });
})();
</script>
{% endblock %}
