{% extends "base.html" %}
{% block title %}All Posts{% endblock %}
{% block meta_description %}Victor Goico's blog — technical writing, development, and building in public.{% endblock %}
{% block body_class %}page-articles{% endblock %}
{% block main_class %}main-content--wide{% endblock %}
{% block content %}

<section class="articles-hero">
    <h1 class="articles-hero-headline">Exploring the intersection of<br>technology and finance.</h1>
    <p class="articles-hero-subtitle">Technical writing on Bitcoin, software development, and building in public.</p>
    {# tag filter will live here when re-enabled in a future phase #}
</section>

<ul class="article-list">
{% for post in posts %}
    <li class="article-card">
        <div class="article-card-meta">
            <div>
                <p class="article-card-meta-date">{{ post.date_short }}</p>
                {% if post.tags %}<p class="article-card-meta-category">{{ post.tags[0] }}</p>{% endif %}
            </div>
            <p class="article-card-meta-author">By Victor M. Goico</p>
        </div>
        <div class="article-card-body">
            <h2 class="article-card-title">{{ post.title }}</h2>
            <p class="article-card-excerpt">{{ post.description or post.excerpt }}</p>
            {% if post.tags %}
            <ul class="article-card-tags">
                {% for tag in post.tags %}<li><span class="article-tag">{{ tag }}</span></li>{% endfor %}
            </ul>
            {% endif %}
            <a href="/{{ post.url }}" class="read-article-btn">Read Article &#8594;</a>
        </div>
    </li>
{% endfor %}
</ul>

{# =====================================================================
   COMMENTED OUT — tag filter, all-tags section, per-item tags, filter JS
   Re-enable in a future phase; tag filter UI lives in .articles-hero
   =====================================================================
{% if all_tags %}
<div class="tag-filter" role="group" aria-label="Filter by tag">
    <span class="tag-filter-label">Filter:</span>
    <div class="tag-filter-buttons">
        <button type="button" class="tag-filter-btn active" data-tag="">All</button>
        {% for tag in all_tags %}
        <button type="button" class="tag-filter-btn" data-tag="{{ tag }}">{{ tag }} ({{ tag_index[tag]|length }})</button>
        {% endfor %}
    </div>
</div>
<section class="all-tags" aria-label="All tags">
    <h2 class="all-tags-title">All tags</h2>
    <ul class="all-tags-list">
        {% for tag in all_tags %}
        <li><a href="/?tag={{ tag | urlencode }}" class="tag">{{ tag }}</a> <span class="tag-count">({{ tag_index[tag]|length }})</span></li>
        {% endfor %}
    </ul>
</section>
{% endif %}
<script>
(function() {
  var buttons = document.querySelectorAll('.tag-filter-btn');
  var items = document.querySelectorAll('.article-card');
  if (!buttons.length || !items.length) return;
  function applyFilter(tag) {
    tag = (tag || '').toLowerCase();
    buttons.forEach(function(b) {
      b.classList.toggle('active', (b.getAttribute('data-tag') || '').toLowerCase() === tag);
    });
    items.forEach(function(item) {
      var tags = (item.getAttribute('data-tags') || '').toLowerCase().split(/\s+/);
      item.classList.toggle('hidden', !(!tag || tags.indexOf(tag) !== -1));
    });
  }
  var params = new URLSearchParams(window.location.search);
  var initialTag = params.get('tag') || '';
  if (initialTag) applyFilter(initialTag);
  buttons.forEach(function(btn) {
    btn.addEventListener('click', function() { applyFilter(this.getAttribute('data-tag')); });
  });
})();
</script>
#}

{% endblock %}
